"use strict";(self["webpackChunkfinalproject"]=self["webpackChunkfinalproject"]||[]).push([[242],{9390:function(t,e,s){s.d(e,{Z:function(){return b}});var a=s(3396),o=s(7139);const i={"aria-label":"breadcrumb"},n={class:"breadcrumb"},r={class:"breadcrumb-item"},c={class:"breadcrumb-item active","aria-current":"page"},l={class:"my-5 text-center"},u={class:"h4"},d={class:"h4 font-mirza ms-2"};function p(t,e){const s=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("nav",i,[(0,a._)("ol",n,[(0,a._)("li",r,[(0,a.Wm)(s,{to:"/"},{default:(0,a.w5)((()=>[(0,a.Uk)("首頁")])),_:1})]),(0,a._)("li",c,(0,o.zw)(t.$route.name),1)])]),(0,a._)("div",l,[(0,a._)("span",u,(0,o.zw)(t.$route.name),1),(0,a._)("span",d,(0,o.zw)(this.$route.meta.name),1)])],64)}var h=s(89);const g={},m=(0,h.Z)(g,[["render",p]]);var b=m},7242:function(t,e,s){s.r(e),s.d(e,{default:function(){return Y}});var a=s(3396),o=s(9242),i=s(7139);const n={class:"container"},r={key:0,class:"row"},c={class:"bg-light shadow p-3 p-md-4 col-11 col-md-8 mx-auto"},l={class:"table align-middle"},u={class:"p-0"},d=["onClick"],p=(0,a._)("i",{class:"bi bi-trash3"},null,-1),h=[p],g={class:"col-3"},m=["onClick"],b={class:"fw-bold"},_={class:"input-group input-group-sm",style:{width:"100px"}},w=["disabled","onChange","onUpdate:modelValue"],f={class:"input-group-text"},v={class:"fw-bold mt-2 mb-0 text-end text-nowrap"},x={colspan:"3"},C=(0,a._)("p",{class:"text-end"},"小計",-1),y={key:0,class:"text-end"},k={class:"bg-success text-light py-1 px-2 rounded"},$={class:"fw-bold"},z=(0,a._)("span",{class:"fw-bold ms-2 text-success"},"折抵",-1),D=(0,a._)("p",{class:"fw-bold text-end"},"總額",-1),L={class:"text-end text-nowrap"},q={key:0,class:"fw-bold text-end text-success text-nowrap"},M={class:"fw-bold text-end text-nowrap"},j={class:"input-group input-group-sm pb-3 px-2 p-mb-0"},U={class:"input-group-text"},I={class:"text-end mt-5"},P={key:1,class:"mb-4 fs-5"};function Z(t,e,s,p,Z,H){const S=(0,a.up)("LoadingCom"),V=(0,a.up)("BreadcrumbCom");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(S,{active:Z.isLoading},null,8,["active"]),(0,a._)("div",n,[(0,a.Wm)(V),Z.carts.length>0?((0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",c,[(0,a._)("table",l,[(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Z.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",u,[(0,a._)("a",{href:"javascript:;",class:"btn btn-sm btn-outline-danger rounded-5",onClick:(0,o.iM)((t=>H.delCart(e)),["prevent"])},h,8,d)]),(0,a._)("td",g,[(0,a._)("a",{href:"javascript:;",onClick:(0,o.iM)((t=>H.getProduct(e.product.id)),["prevent"])},[(0,a._)("div",{style:(0,i.j5)({backgroundImage:`url(${e.product.imageUrl})`}),class:"sm-imgs bg-center"},null,4)],8,m)]),(0,a._)("td",null,[(0,a._)("p",b,(0,i.zw)(e.product.title),1),(0,a._)("div",_,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",min:"1",disabled:e.id===Z.loadingItem,onChange:t=>H.updateCart(e),"onUpdate:modelValue":t=>e.qty=t},null,40,w),[[o.nr,e.qty,void 0,{number:!0}]]),(0,a._)("div",f,"/ "+(0,i.zw)(e.product.unit),1)])]),(0,a._)("td",v,(0,i.zw)(t.$filters.currency(e.product.price)),1)])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[(0,a._)("td",x,[C,Z.cart.final_total!==Z.cart.total?((0,a.wg)(),(0,a.iD)("p",y,[(0,a._)("span",k,[(0,a.Uk)("優惠券: "),(0,a._)("span",$,(0,i.zw)(Z.carts[0].coupon.title),1)]),z])):(0,a.kq)("",!0),D]),(0,a._)("td",null,[(0,a._)("p",L,(0,i.zw)(t.$filters.currency(Z.cart.total)),1),Z.cart.final_total!==Z.cart.total?((0,a.wg)(),(0,a.iD)("p",q,"- "+(0,i.zw)(t.$filters.currency(Z.cart.total-Z.cart.final_total)),1)):(0,a.kq)("",!0),(0,a._)("p",M,(0,i.zw)(t.$filters.currency(Z.cart.final_total)),1)])])])]),(0,a._)("div",j,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[0]||(e[0]=t=>Z.code=t),onKeyup:e[1]||(e[1]=(0,o.D2)(((...t)=>H.useCoupon&&H.useCoupon(...t)),["enter"]))},null,544),[[o.nr,Z.code,void 0,{lazy:!0}]]),(0,a._)("div",U,[(0,a._)("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=(0,o.iM)(((...t)=>H.useCoupon&&H.useCoupon(...t)),["prevent"]))}," 套用優惠碼 ")])]),(0,a._)("div",I,[(0,a._)("button",{class:"btn-shadow btn btn-primary text-light",onClick:e[3]||(e[3]=(0,o.iM)(((...t)=>H.goCheckout&&H.goCheckout(...t)),["prevent"]))},"前往結帳")])])])):((0,a.wg)(),(0,a.iD)("p",P,"目前購物車是空的，請選擇商品加入。"))])],64)}s(7658);var H=s(9390),S={data(){return{carts:[],cart:{},isLoading:!1,loadingItem:"",code:""}},created(){this.getCarts()},methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/cart";this.axios.get(t).then((t=>{this.isLoading=!1,this.carts=t.data.data.carts,this.cart=t.data.data}))},getProduct(t){this.$router.push(`/user/product/${t}`)},delCart(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/cart/${t.id}`;this.axios.delete(e).then((t=>{this.isLoading=!1,this.getCarts(),this.PushMessageState(t,"刪除"),this.emitter.emit("cart-qty")}))},updateCart(t){this.loadingItem=t.id;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/cart/${t.id}`,s={product_id:t.id,qty:t.qty};this.axios.put(e,{data:s}).then((t=>{this.loadingItem="",this.getCarts()}))},useCoupon(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/coupon",e={code:this.code};this.axios.post(t,{data:e}).then((t=>{this.isLoading=!1,this.getCarts(),this.PushMessageState(t,"套用優惠券")}))},goCheckout(){this.$router.push("/user/info")}},components:{BreadcrumbCom:H.Z},inject:["emitter","PushMessageState"]},V=s(89);const W=(0,V.Z)(S,[["render",Z]]);var Y=W}}]);
//# sourceMappingURL=242.472ae804.js.map