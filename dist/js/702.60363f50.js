"use strict";(self["webpackChunkfinalproject"]=self["webpackChunkfinalproject"]||[]).push([[702],{5741:function(t,e,a){var l=a(7972),s=a.n(l);e["Z"]={data(){return{modal:{}}},mounted(){this.modal=new(s())(this.$refs.modal)},methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}}}},9227:function(t,e,a){a.d(e,{Z:function(){return v}});var l=a(3396),s=a(9242),o=a(7139);const i={"aria-label":"Page navigation",class:"mt-4"},n={class:"pagination justify-content-center pagination-sm"},r={class:"page-item"},d=(0,l._)("span",{"aria-hidden":"true"},"«",-1),c=[d],u=["onClick"],p={class:"page-item"},m=(0,l._)("span",{"aria-hidden":"true"},"»",-1),h=[m];function g(t,e,a,d,m,g){return(0,l.wg)(),(0,l.iD)("nav",i,[(0,l._)("ul",n,[(0,l._)("li",r,[(0,l._)("a",{class:"page-link",href:"#",onClick:e[0]||(e[0]=(0,s.iM)((t=>g.updatePage(m.currentPage-1)),["prevent"])),"aria-label":"Previous"},c)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,(t=>((0,l.wg)(),(0,l.iD)("li",{class:(0,o.C_)(["page-item",{active:t===a.pages.current_page}]),key:t},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((e=>g.updatePage(t)),["prevent"])},(0,o.zw)(t),9,u)],2)))),128)),(0,l._)("li",p,[(0,l._)("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=(0,s.iM)((t=>g.updatePage(m.currentPage+1)),["prevent"])),"aria-label":"Next"},h)])])])}var b={data(){return{currentPage:1}},props:["pages"],methods:{updatePage(t){t>0&&t<=this.pages.total_pages&&(this.$emit("update-page",t),document.documentElement.scrollTop=0,this.currentPage=t)}}},_=a(89);const f=(0,_.Z)(b,[["render",g]]);var v=f},5702:function(t,e,a){a.r(e),a.d(e,{default:function(){return Jt}});var l=a(3396),s=a(9242),o=a(7139);const i={class:"d-flex justify-content-between align-items-center"},n=(0,l._)("h5",null,"商品",-1),r={class:"d-flex"},d={class:"me-3"},c={class:"input-group"},u=["value"],p=(0,l._)("button",{class:"btn btn-secondary input-group-text",type:"submit"},[(0,l._)("i",{class:"bi bi-search"})],-1),m={class:"text-end"},h={class:"bg-light border rounded mt-3 shadow"},g={class:"table mt-4 align-middle"},b=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{width:"100",class:"text-nowrap"},"圖片"),(0,l._)("th",{width:"150",class:"text-nowrap"},"商品名稱"),(0,l._)("th",{width:"100",class:"d-none d-md-table-cell"},"原價"),(0,l._)("th",{width:"100"},"售價"),(0,l._)("th",{width:"120",class:"text-nowrap"},"是否啟用"),(0,l._)("th",{width:"150"},"編輯")])],-1),_={class:"text-nowrap d-none d-md-table-cell"},f={class:"text-nowrap"},v={class:"form-check form-switch"},w=["onUpdate:modelValue"],P={class:"form-check-label",for:"flexSwitchCheckChecked"},y={class:"btn-group btn-group-sm"},x=["onClick"],k=["onClick"];function M(t,e,a,M,U,C){const $=(0,l.up)("LoadingCom"),I=(0,l.up)("ProductsModal"),D=(0,l.up)("DelModal"),L=(0,l.up)("PaginationCom");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)($,{active:U.isLoading},null,8,["active"]),(0,l._)("div",i,[n,(0,l._)("div",r,[(0,l._)("form",d,[(0,l._)("div",c,[(0,l._)("input",{class:"form-control form-control-sm",type:"search",placeholder:"請輸入商品名稱",value:U.searchInput,onChange:e[0]||(e[0]=t=>U.searchInput=t.target.value),"aria-label":"Search"},null,40,u),p])]),(0,l._)("div",m,[(0,l._)("button",{class:"btn btn-primary text-white",type:"button",onClick:e[1]||(e[1]=(0,s.iM)((t=>C.openModal(!0)),["prevent"]))},"新增商品")])])]),(0,l._)("div",h,[(0,l._)("table",g,[b,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(C.searchData,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,[(0,l._)("div",{style:(0,o.j5)([{backgroundImage:`url(${e.imageUrl})`},{height:"50px"}]),class:"bg-center"},null,4)]),(0,l._)("td",null,(0,o.zw)(e.title),1),(0,l._)("td",_,(0,o.zw)(t.$filters.currency(e.origin_price)),1),(0,l._)("td",f,(0,o.zw)(t.$filters.currency(e.price)),1),(0,l._)("td",null,[(0,l._)("div",v,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckChecked","onUpdate:modelValue":t=>e.is_enabled=t},null,8,w),[[s.e8,e.is_enabled]]),(0,l._)("label",P,(0,o.zw)(e.is_enabled?"啟用":"未啟用"),1)])]),(0,l._)("td",null,[(0,l._)("div",y,[(0,l._)("button",{class:"btn btn-outline-primary p-1 p-md-2",onClick:(0,s.iM)((t=>C.openModal(!1,e)),["prevent"])},"編輯",8,x),(0,l._)("button",{class:"btn btn-outline-danger p-1 p-md-2",onClick:(0,s.iM)((t=>C.delModal(e)),["prevent"])},"刪除",8,k)])])])))),128))])])]),(0,l.Wm)(I,{ref:"productModal",product:U.tempProduct,onUpdateProduct:C.updateProduct},null,8,["product","onUpdateProduct"]),(0,l.Wm)(D,{ref:"delModal",item:U.tempProduct,onDelItem:C.delItem},null,8,["item","onDelItem"]),U.searchInput?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(L,{key:0,pages:U.pagination,onUpdatePage:C.getProducts},null,8,["pages","onUpdatePage"]))],64)}const U={class:"modal",tabindex:"-1",ref:"modal"},C={class:"modal-dialog modal-xl",role:"document"},$={class:"modal-content border-0"},I=(0,l._)("div",{class:"modal-header bg-primary text-white"},[(0,l._)("h4",{class:"modal-title",id:"exampleModalLabel"},"產品"),(0,l._)("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},L={class:"row"},j={class:"col-sm-4"},V={class:"mb-3"},Z=(0,l._)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),z={type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結",ref:"fileInput"},S={class:"mb-3"},F=(0,l._)("label",{for:"customFile",class:"form-label"},"或 上傳圖片 ",-1),H={type:"file",id:"customFile",class:"form-control",ref:"fileInput2"},N={class:"text-danger"},Y={class:"btn-group",role:"group","aria-label":"Basic example"},K={key:0,class:"mt-3"},W={class:"d-flex justify-content-between"},q=(0,l._)("h6",{class:"text-primary"},"主圖",-1),A=["src"],O={class:"d-flex justify-content-between"},B={class:"text-primary"},E=["onClick"],T=["src"],G={class:"col-sm-8"},J={class:"mb-3"},Q=(0,l._)("label",{for:"title",class:"form-label"},"標題",-1),R={class:"row gx-2"},X={class:"mb-3 col-md-6"},tt=(0,l._)("label",{for:"category",class:"form-label"},"分類",-1),et=(0,l._)("option",{disabled:""},"請輸入分類",-1),at=(0,l._)("option",{value:"plants"},"植栽",-1),lt=(0,l._)("option",{value:"flowers"},"乾燥花",-1),st=[et,at,lt],ot={class:"mb-3 col-md-6"},it=(0,l._)("label",{for:"unit",class:"form-label"},"單位",-1),nt=(0,l._)("option",{value:"",selected:"",disabled:""},"請輸入單位",-1),rt=(0,l._)("option",{value:"盆"},"盆",-1),dt=(0,l._)("option",{value:"束"},"束",-1),ct=[nt,rt,dt],ut={class:"row gx-2"},pt={class:"mb-3 col-md-6"},mt=(0,l._)("label",{for:"origin_price",class:"form-label"},"原價",-1),ht={class:"mb-3 col-md-6"},gt=(0,l._)("label",{for:"price",class:"form-label"},"售價",-1),bt=(0,l._)("hr",null,null,-1),_t={class:"mb-3"},ft=(0,l._)("label",{for:"description",class:"form-label"},"產品描述",-1),vt={class:"mb-3"},wt=(0,l._)("label",{for:"content",class:"form-label"},"說明內容",-1),Pt={class:"mb-3"},yt={class:"form-check"},xt=(0,l._)("label",{class:"form-check-label",for:"is_gift"},"是否為送禮首選",-1),kt={class:"mb-3"},Mt={class:"form-check"},Ut=(0,l._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Ct={class:"modal-footer"},$t=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function It(t,e,a,i,n,r){return(0,l.wg)(),(0,l.iD)("div",U,[(0,l._)("div",C,[(0,l._)("div",$,[I,(0,l._)("div",D,[(0,l._)("div",L,[(0,l._)("div",j,[(0,l._)("div",V,[Z,(0,l._)("input",z,null,512)]),(0,l._)("div",S,[F,(0,l._)("input",H,null,512),(0,l._)("p",N,(0,o.zw)(n.wrongMessage),1)]),(0,l._)("div",Y,[(0,l._)("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:e[0]||(e[0]=(0,s.iM)((t=>r.upload(!0)),["prevent"]))},"設為主圖"),(0,l._)("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:e[1]||(e[1]=(0,s.iM)((t=>r.upload(!1)),["prevent"]))},"加入其他圖片")]),n.tempProduct.imageUrl?((0,l.wg)(),(0,l.iD)("div",K,[(0,l._)("div",W,[q,(0,l._)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:e[2]||(e[2]=t=>n.tempProduct.imageUrl="")},"移除")]),(0,l._)("img",{class:"img-fluid mt-2",src:n.tempProduct.imageUrl,alt:"img"},null,8,A)])):(0,l.kq)("",!0),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.tempProduct.imagesUrl,((t,e)=>((0,l.wg)(),(0,l.iD)("div",{key:t+`${e}`,class:"mt-3"},[(0,l._)("div",O,[(0,l._)("h6",B,"圖片 "+(0,o.zw)(e+1),1),(0,l._)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:t=>n.tempProduct.imagesUrl.splice(e,1)},"移除",8,E)]),(0,l._)("img",{class:"img-fluid mt-2 w-75",src:t,alt:"img"},null,8,T)])))),128))]),(0,l._)("div",G,[(0,l._)("div",J,[Q,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":e[3]||(e[3]=t=>n.tempProduct.title=t)},null,512),[[s.nr,n.tempProduct.title]])]),(0,l._)("div",R,[(0,l._)("div",X,[tt,(0,l.wy)((0,l._)("select",{name:"category",class:"form-select",id:"category","onUpdate:modelValue":e[4]||(e[4]=t=>n.tempProduct.category=t)},st,512),[[s.bM,n.tempProduct.category]])]),(0,l._)("div",ot,[it,(0,l.wy)((0,l._)("select",{class:"form-select",id:"unit","onUpdate:modelValue":e[5]||(e[5]=t=>n.tempProduct.unit=t)},ct,512),[[s.bM,n.tempProduct.unit]])])]),(0,l._)("div",ut,[(0,l._)("div",pt,[mt,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"origin_price",min:"1",placeholder:"請輸入原價","onUpdate:modelValue":e[6]||(e[6]=t=>n.tempProduct.origin_price=t)},null,512),[[s.nr,n.tempProduct.origin_price]])]),(0,l._)("div",ht,[gt,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"price",min:"1",placeholder:"請輸入售價","onUpdate:modelValue":e[7]||(e[7]=t=>n.tempProduct.price=t)},null,512),[[s.nr,n.tempProduct.price]])])]),bt,(0,l._)("div",_t,[ft,(0,l.wy)((0,l._)("textarea",{type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述","onUpdate:modelValue":e[8]||(e[8]=t=>n.tempProduct.description=t)},null,512),[[s.nr,n.tempProduct.description]])]),(0,l._)("div",vt,[wt,(0,l.wy)((0,l._)("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":e[9]||(e[9]=t=>n.tempProduct.content=t)},null,512),[[s.nr,n.tempProduct.content]])]),(0,l._)("div",Pt,[(0,l._)("div",yt,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,id:"is_gift","onUpdate:modelValue":e[10]||(e[10]=t=>n.tempProduct.is_gift=t)},null,512),[[s.e8,n.tempProduct.is_gift]]),xt])]),(0,l._)("div",kt,[(0,l._)("div",Mt,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,id:"is_enabled","onUpdate:modelValue":e[11]||(e[11]=t=>n.tempProduct.is_enabled=t)},null,512),[[s.e8,n.tempProduct.is_enabled]]),Ut])])])])]),(0,l._)("div",Ct,[$t,(0,l._)("button",{type:"button",class:"btn btn-outline-primary",onClick:e[12]||(e[12]=(0,s.iM)((e=>t.$emit("update-product",n.tempProduct)),["prevent"]))},"確認")])])])],512)}a(7658);var Dt=a(5741),Lt={data(){return{tempProduct:{},wrongMessage:"",mainImg:!0}},props:{product:{type:Object,default(){return{}}}},watch:{product(){this.product.imagesUrl?this.tempProduct=this.product:this.tempProduct={...this.product,imagesUrl:[]}}},emits:["update-product"],methods:{upload(t){this.wrongMessage="";const e=this.$refs.fileInput.value,a=this.$refs.fileInput2.files[0];this.tempProduct.imagesUrl.length>1&&!1===t?this.wrongMessage="其他圖片最多只能上傳 2 張":e&&!a?(t?this.tempProduct.imageUrl=e:this.tempProduct.imagesUrl.push(e),this.$refs.fileInput.value=""):!e&&a?this.uploadFile(t,a):this.wrongMessage="上傳失敗，請指定一種上傳方式"},uploadFile(t,e){const a=new FormData;a.append("file-to-upload",e);const l="https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/upload";this.axios.post(l,a).then((e=>{e.data.success&&!0===t?this.tempProduct.imageUrl=e.data.imageUrl:e.data.success&&!1===t?this.tempProduct.imagesUrl.push(e.data.imageUrl):this.wrongMessage=e.data.message.message})),this.$refs.fileInput2.value=""}},mixins:[Dt.Z]},jt=a(89);const Vt=(0,jt.Z)(Lt,[["render",It]]);var Zt=Vt;const zt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},St={class:"modal-dialog"},Ft={class:"modal-content"},Ht=(0,l._)("div",{class:"modal-header bg-primary text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},"刪除產品"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Nt={class:"modal-body"},Yt={class:"text-danger"},Kt={class:"modal-footer"},Wt=(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function qt(t,e,a,s,i,n){return(0,l.wg)(),(0,l.iD)("div",zt,[(0,l._)("div",St,[(0,l._)("div",Ft,[Ht,(0,l._)("div",Nt,[(0,l.Uk)(" 請確認是否刪除產品 "),(0,l._)("span",Yt,(0,o.zw)(a.item.title),1),(0,l.Uk)("，刪除後將無法復原。 ")]),(0,l._)("div",Kt,[Wt,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=e=>t.$emit("del-item",a.item))},"確認")])])])],512)}var At={props:{item:{}},emits:["del-item"],mixins:[Dt.Z]};const Ot=(0,jt.Z)(At,[["render",qt]]);var Bt=Ot,Et=a(9227),Tt={data(){return{allProducts:[],products:[],pagination:{total_pages:""},tempProduct:{},isNew:!1,isLoading:!1,searchInput:""}},created(){this.getProducts(),this.getAllProducts(),this.searchInput=""},mounted(){this.emitter.emit("products",this.products)},methods:{getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/products?page=${t}`;this.axios.get(e).then((t=>{this.isLoading=!1,this.products=t.data.products,this.pagination=t.data.pagination}))},openModal(t,e){this.tempProduct=t?{}:{...e},this.isNew=t,this.$refs.productModal.showModal(),this.$refs.productModal.wrongMessage=""},updateProduct(t){this.isLoading=!0,this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/product",a="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/product/${t.id}`,a="put"),this.axios[a](e,{data:this.tempProduct}).then((t=>{this.isLoading=!1,this.$refs.productModal.hideModal(),this.getProducts(this.pagination.current_page),this.PushMessageState(t,"更新")}))},delModal(t){this.tempProduct={...t},this.$refs.delModal.showModal()},delItem(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/product/${t.id}`;this.axios.delete(e).then((t=>{this.isLoading=!1,this.$refs.delModal.hideModal(),this.getProducts(this.pagination.current_page),this.PushMessageState(t,"刪除")}))},getAllProducts(){const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/products/all";this.axios.get(t).then((t=>{this.allProducts=Object.values(t.data.products)}))}},computed:{searchData(){let t=[];return t=this.searchInput?this.allProducts.filter((t=>t.title.match(this.searchInput))):this.products,t}},components:{ProductsModal:Zt,DelModal:Bt,PaginationCom:Et.Z},inject:["emitter","PushMessageState"]};const Gt=(0,jt.Z)(Tt,[["render",M]]);var Jt=Gt}}]);
//# sourceMappingURL=702.60363f50.js.map